<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>方法</title>
	</head>
	<body>
<h2>Hello World!</h2>

<button id="bt_A" onclick="clickButton('A')">AAAAAA</button>
<div id="div_A" style="background-color: #00b7ee; width: 300px; height: 50px;">index-------A</div>
<br />

<button id="bt_B" onclick="clickButton('B')">BBBBBBB</button>
<div id="div_B" style="background-color: #9cb945; width: 300px; height: 50px;">index-------B</div>
<br />

<button id="bt_C" onclick="clickButton('C')">CCCCCCC</button>
<div id="div_C" style="background-color: salmon; width: 300px; height: 50px;">index-------C</div>

</body>

<script src="../js/jquery.1.9.1.min.js"></script>
<script language="javascript">
    var idx;
    function clickButton(selIdx) {
        idx = selIdx;
        goToIndex();
        pushHistory();
    }

    function goToIndex() {
        if ("A" == idx) {
            $("#div_A").css("display", "block");
            $("#div_B").css("display", "none");
            $("#div_C").css("display", "none");
        } else if ("B" == idx) {
            $("#div_A").css("display", "none");
            $("#div_B").css("display", "block");
            $("#div_C").css("display", "none");
        } else if ("C" == idx) {
            $("#div_A").css("display", "none");
            $("#div_B").css("display", "none");
            $("#div_C").css("display", "block");
        } else {
            $("#div_A").css("display", "block");
            $("#div_B").css("display", "block");
            $("#div_C").css("display", "block");
        }
    }

    function goback() {
        if ("ALL" == idx) {
            history.go(-1);
        } else {
            if ("C" == idx) {
                idx = "B";
            } else if ("B" == idx) {
                idx = "A";
            } else if ("A" == idx) {
                idx = "ALL";
            }
            goToIndex();
        }
    }

    window.addEventListener("popstate", function (e) {
        //alert("我监听到了浏览器的返回按钮事件啦");
        console.info("-------------------- " + e.state);
        // 该干嘛干嘛
        goback();
    }, false);

    function pushHistory() {
        var state = {
            title: "title",
            url: "#"
        };
        window.history.pushState(state, "title", "#");
    }

</script>
</html>
